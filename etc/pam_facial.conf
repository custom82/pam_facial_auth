###############################################
#   PAM Facial Authentication Configuration   #
###############################################

# ============================================================
#   BASEDIR
# ============================================================
# Contiene:
#   images/<user>/
#   models/<user>.xml  (LBPH/eigen/fisher legacy)
#   embeddings/<user>.bin (SFace)
#
basedir = /etc/pam_facial_auth


# ============================================================
#   FACE DETECTOR BACKEND
# ============================================================
# detector_profile determina il metodo di face detection:
#
#   haar         → Haar cascade (legacy, lento)
#   yunet_cpu    → YUNet DNN CPU
#   yunet_cuda   → YUNet DNN CUDA
#
# Se scegli yunet_cuda ma OpenCV non ha CUDA, verrà usato yunet_cpu.
#
detector_profile = yunet_cpu


# ============================================================
#   YUNet MODEL PATH
# ============================================================
# Modello YUNet (OpenCV Zoo):
# https://github.com/opencv/opencv_zoo/tree/master/models/face_detection_yunet
#
# Puoi usare:
#   face_detection_yunet_2023mar.onnx
#   face_detection_yunet_2023mar_int8.onnx
#
yunet_model = /usr/share/opencv4/models/face_detection_yunet_2023mar.onnx


# ============================================================
#   SFace Recognition Model
# ============================================================
# Modello di face recognition basato su embeddings 128D.
#
# Versioni disponibili:
#   - face_recognition_sface_2021dec.onnx
#   - face_recognition_sface_2021dec_int8.onnx (più veloce)
#
sface_model = /usr/share/opencv4/models/face_recognition_sface_2021dec.onnx

# Distanza massima per considerare un match valido:
#   Cosine distance: 0.40–0.55 tipico
#
sface_threshold = 0.50


# ============================================================
#   HAAR CASCADE (legacy)
# ============================================================
haar_cascade_path = /usr/share/opencv4/haarcascades/haarcascade_frontalface_default.xml


# ============================================================
#   CAMERA SETTINGS
# ============================================================
device           = /dev/video0
fallback_device  = false

width            = 1280
height           = 720
frames           = 100
sleep_ms         = 150


# ============================================================
#   DEBUG & LOG
# ============================================================
debug     = false
nogui     = true
log_file  = /var/log/pam_facial_auth.log


# ============================================================
#   LEGACY RECOGNIZERS (LBPH / Eigen / Fisher)
#   — ancora supportati per retro-compatibilità
# ============================================================
lbph_threshold     = 80.0      # LBPH: minore = migliore
eigen_threshold    = 6000      # Eigen: maggiore = peggiore
fisher_threshold   = 1000

eigen_components   = 0
fisher_components  = 0

# Forza overwrite dei modelli legacy XML
force_overwrite    = false
ignore_failure     = false


# ============================================================
#   EMBEDDINGS DIR (per SFace)
# ============================================================
# Gli embeddings vengono salvati in:
#   <basedir>/embeddings/<user>.bin
#
embeddings_dir = /etc/pam_facial_auth/embeddings
