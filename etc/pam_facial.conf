###############################################################
#   PAM Facial Authentication – Configuration File (2025)
###############################################################

# =============================================================
# PATH MODELLI E DIRECTORY BASE
# =============================================================

# Directory contenente i modelli utente: <user>.xml
models_dir=/etc/pam_facial_auth/models

# Directory di lavoro, salvataggio immagini e debug
work_dir=/var/lib/pam_facial_auth


# =============================================================
# CAMERA SETTINGS
# =============================================================

# Webcam principale
device=/dev/video0

# Usa automaticamente /dev/video1 se la primaria fallisce
fallback_device=true

# Risoluzione video
width=640
height=480

# Numero di frame da catturare per l’addestramento
capture_count=50

# Delay tra frame (ms)
capture_delay=50


# =============================================================
# FACE DETECTOR
# =============================================================

# detector_profile può essere:
#   yunet         -> ONNX YuNet FP32
#   yunet_int8    -> YuNet INT8 (più veloce)
#   haar          -> Haar Cascade (fallback)
#   none          -> disattivato
detector_profile=yunet

# YuNet ONNX (installati da Gentoo opencv_contrib)
yunet_model=/usr/share/opencv4/dnn/models/face_detection_yunet_2023mar.onnx
yunet_model_int8=/usr/share/opencv4/dnn/models/face_detection_yunet_2023mar_int8.onnx

# Haar Cascade (fallback)
haar_model=/usr/share/opencv4/haarcascades/haarcascade_frontalface_default.xml


# =============================================================
# RECOGNIZER
# =============================================================

# recognizer può essere:
#   eigen
#   fisher
#   lbph
#   sface
#   auto     -> legge dal file XML del modello (consigliato)
recognizer=auto


# =============================================================
# SFace CONFIGURATION (DNN)
# =============================================================

# Modelli ONNX SFace (installati da opencv_contrib)
sface_model=/usr/share/opencv4/dnn/models/face_recognition_sface_2021dec.onnx
sface_model_int8=/usr/share/opencv4/dnn/models/face_recognition_sface_2021dec_int8.onnx

# Utilizza FP32 se disponibile, altrimenti INT8
sface_prefer_fp32=true


# =============================================================
# THRESHOLDS PER OGNI METODO
# =============================================================

# --- EigenFace ---
# Valori tipici:
#   50 = molto severo
#   500 = permissivo
eigen_threshold=350


# --- FisherFace ---
# Valori consigliati:
#   50–150 severo
#   150–250 permissivo
fisher_threshold=150


# --- LBPH ---
# Valori:
#   40–70 = severo
#   70–110 = permissivo
lbph_threshold=80


# --- SFace (cosine distance) ---
# In SFace viene usata la distanza COSINE:
#   0.2 = severissimo
#   0.4 = raccomandato
#   0.5 = permissivo
sface_threshold=0.40


# =============================================================
# DEBUG & LOGGING
# =============================================================

# Abilita log verbose nel modulo PAM
debug=false

# Salva immagini dei tentativi falliti
save_failed_images=false

# Log file globale
log_file=/var/log/pam_facial_auth.log
