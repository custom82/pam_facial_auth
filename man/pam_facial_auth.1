.TH PAM_FACIAL_AUTH 8 "2025-11-09" "v1.0" "System Administration"
.SH NAME
pam_facial_auth \- PAM module for facial authentication

.SH SYNOPSIS
.B facial_training
.RI [ options ] <data_dir>

.B facial_test
.RI [ options ] <image_path>

.B pam_facial_auth.so
.RI [ options ]

.SH DESCRIPTION
The pam-facial-auth package provides a PAM (Pluggable Authentication Module) for facial recognition. This package allows administrators to use facial recognition as part of the PAM authentication process.

.PP
The package includes two main utilities:
- **facial_training**: Used to train the facial recognition model using images of known users.
- **facial_test**: Used to test the facial recognition model with a new image to verify user identity.

.PP
The module **pam_facial_auth.so** is configured through the PAM configuration files and supports various options to customize the facial authentication process.

.SH COMMANDS

.TP
.B facial_training
.RI [ options ] <data_dir>
The **facial_training** command is used to train the facial recognition model.

.PP
Options:
.TP
.B <data_dir>
The path to the directory containing user images. The directory should be organized with subdirectories for each user. Each subdirectory should contain images of the user's face.

.TP
.B --technique <technique>
Select the face recognition technique to use. Options are:
  - eigen (default)
  - fisher
  - lbph

.TP
.B --haar-cascade <path>
Path to the Haar cascade XML file used for face detection (optional). Default: `etc/haarcascade_frontalface_default.xml`.

.TP
Example usage:
.RS
.B facial_training /path/to/data_dir
.RE

.TP
Example with technique and custom Haar cascade:
.RS
.B facial_training /path/to/data_dir fisher /path/to/haarcascade_frontalface_default.xml
.RE

.TP
.B facial_test
.RI [ options ] <image_path>
The **facial_test** command is used to test the facial recognition model.

.PP
Options:
.TP
.B <image_path>
The path to the image to be tested against the trained model.

.TP
.B --threshold <value>
Set the confidence threshold for recognition. If the confidence is below this value, the authentication will fail. Default: 50.0

.TP
Example usage:
.RS
.B facial_test /path/to/test_image.jpg
.RE

.TP
Example with custom threshold:
.RS
.B facial_test /path/to/test_image.jpg --threshold 60.0
.RE

.SH PAM CONFIGURATION

To use the **pam-facial-auth** module for PAM authentication, add the following line to the appropriate PAM configuration file (e.g., `/etc/pam.d/sshd`, `/etc/pam.d/sudo`):

.TP
.B auth required pam_facial_auth.so timeout=30 threshold=50.0 imageCapture=true imageDir=/var/lib/motioneye/Camera1

.PP
The parameters that can be configured in the PAM configuration file are:
- **timeout**: The maximum time (in seconds) to wait for facial recognition. Default is 30 seconds.
- **threshold**: The confidence threshold for facial recognition. Default is 50.0. Lower values increase the chance of a match.
- **imageCapture**: If set to `true`, the module will actively capture images from the camera. If `false`, it will look for images in the directory specified by **imageDir**.
- **imageDir**: Path to the directory where the images are stored for facial recognition. Used when **imageCapture** is set to `false`.

.SH FILES
.TP
.B /etc/pam.d/pam-facial-auth.conf
Configuration file for PAM facial authentication.

.TP
.B /etc/pam.d/sshd
An example PAM configuration file where facial authentication can be enabled for SSH login.

.SH EXAMPLES

.PP
To train the facial recognition model:
.RS
.B facial_training /path/to/data_dir
.RE

.PP
To test the facial recognition model:
.RS
.B facial_test /path/to/test_image.jpg
.RE

.SH SEE ALSO
.BR pam (8),
.BR facial_recognition (1),
.BR opencv (1)

.SH AUTHOR
This module and tools are developed by [Your Name].
